<header>
  <heading></heading>
</header>
<section id="sidebar">
  <sidebar></sidebar>
</section>
<section id="main">
    <div class="row" id="banner">
        <div class="banner">
            <h1 *ngIf="organisationId > 0">{{organisation?.name}}</h1>
            <h1 *ngIf="organisationId == 0">Mijn Sessies</h1>
        </div>
    </div>
    <div class="row" id="newSessionRow" *ngIf="organisationId != 0">
        <div class="col-xs-9"></div>
        <div class="col-xs-3">
          <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#sessionModal">Nieuwe sessie</button>
        </div>
    </div>
    <div class="row sessionsoverview">
        <div class="row sessionsoverview">
            <div class="col-xs-12">
                <h2>Open sessies</h2>
                <hr class="blackLine" />
                <div class="col-xs-6 overviewSessionButton" *ngIf="!noOpenSession" *ngFor="#session of openSessions">
                    <button class="btn btn-info btn-lg" (click)="onSelect(session)">{{session?.description}}</button>
                </div>
                <div *ngIf="noOpenSession">Er lopen geen sessies waar je voor uitgenodigd bent.</div>
            </div>
        </div>
        <div class="row sessionsoverview">
            <div class="col-xs-12">
                <h2>Geplande sessies</h2>
                <hr class="blackLine" />
                <div class="col-xs-6 overviewSessionButton" *ngFor="#session of futureSessions">
                    <button class="btn btn-info btn-lg" (click)="onSelect(session)">{{session?.description}}</button>
                </div>
            </div>
        </div>
        <div class="row sessionsoverview">
            <div class="col-xs-12">
                <h2>Gespeelde sessies</h2>
                <hr class="blackLine" />
                <div class="col-xs-6 overviewSessionButton" *ngFor="#session of pastSessions">
                    <button class="btn btn-info btn-lg" (click)="onSelect(session)">{{session?.description}}</button>
                </div>
            </div>
        </div>
        <div class="col-xs-6" [hidden]="sessionDetailHidden">
            <div class="row">
                <div class="col-xs-12">
                    <img src="../../resources/images/descriptionicon.png" class="descriptionicon" /> {{sessionDetail.description}}<br /><br />
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <img src="../../resources/images/linkicon.png" class="sessionlink" />http://kandoe-angular.azurewebsites.net/#/sessies/{{ sessionDetail.subthemeId }}
                    <br /><br />
                    <b>Aantal deelnemers: </b>{{ sessionDetail.participants | sessionParticipantsPipe }}<br /><br />
                </div>
            </div>
            <div class="row">
                <div class="col-xs-6 start">
                    <b>Start:</b> {{ sessionDetail.start | date:'dd MMMM yyyy'}} <br />
                </div>
                <div class="col-xs-6 end">
                    <b>Einde:</b> {{ sessionDetail.end | date:'dd MMMM yyyy'}} <br />
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <div class="progress">
                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuemin="0" aria-valuemax="100" [style]=progress>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row sessionsbuttons">
                <div class="col-xs-4">
                    <button type="button" *ngIf="!isParticipant" class="btn btn-info" data-toggle="modal" data-target="#chooseCardModal">Speel</button>
                    <button type="button" *ngIf="!sessionDetail.isFinished && isParticipant" class="btn btn-info" (click)="playSession(sessionDetail)">Speel</button>
                    <button type="button" *ngIf="sessionDetail.isFinished" class="btn btn-info" (click)="analyseSession(sessionDetail)">Analyseer</button>
                </div>
                <div class="col-xs-4">
                    <button type="button" class="btn btn-info" (click)="onClickChangeSession()" data-toggle="modal" data-target="#cloneSessionModal">Kopieer</button>
                </div>
                <div class="col-xs-4">
                    <button type="button" class="btn btn-info" (click)="onClickChangeSession()" data-toggle="modal" data-target="#editSessionModal">Wijzigen</button>
                </div>
            </div>
        </div>
    </div>
    <div class="row sesssionsfooter"></div>

    <!-- create session modal -->
    <div id="sessionModal" class="modal" role="form">
        <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Nieuwe sessie</h4>
        </div>
        <div class="modal-body">

            <!-- Create session form -->
            <form (ngSubmit)="createSession()" #sessionForm="ngForm">
                <div class="form-group">
                    <label for="description">Omschrijving</label>
                    <input type="text" class="form-control" [(ngModel)]="sessionModel.description"/>
                </div>
                <div class="form-group">
                    <label for="subtheme">Subthema</label>
                    <select class="form-control" [(ngModel)]="sessionModel.subtheme" id="subthemeSelect">
                        <option *ngFor="#s of subthemes" [value]="s.id">{{ s.name }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="cardCreationAllowed">Kaartjes aanmaken toegestaan: </label>
                    <div class="checkbox">
                        <label><input type="checkbox" [(ngModel)]="sessionModel.cardCreationAllowed"/></label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="startDate">Maximum kaartjes: </label>
                    <input type="number" class="form-control" [(ngModel)]="sessionModel.maxCardsToChoose" />
                </div>
                <div class="form-group"> 
                    <label for="startDate">Start datum</label>
                    <input type="date" class="form-control" [(ngModel)]="sessionModel.start"/>
                </div>
                <div class="form-group">
                    <label for="endDate">Eind datum</label>
                    <input type="date" class="form-control" [(ngModel)]="sessionModel.end"/>
                </div>
                <div class="form-group">
                    <label for="maxParticipants">Maximum aantal deelnemers: </label>
                    <input type="number" class="form-control" [(ngModel)]="sessionModel.maxParticipants" />
                </div>
                <div class="form-group">
                    <label for="users">Gebruikers toevoegen</label>
                    <br />
                    <input type="text" name="users" class="form-control" id="users" [(ngModel)]="users">
                </div>
                <button type="submit" class="btn btn-info" [disabled]="!sessionForm.form.valid" data-toggle="modal" data-target="#sessionModal">Maak sessie aan</button>
                <button type="button" class="btn btn-info" data-dismiss="modal">Sluit</button>
            </form>
        </div>
        </div>
        </div>
    </div>

    <!-- Edit session modal -->
    <div id="editSessionModal" class="modal" role="form">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Wijzig sessie</h4>
                </div>
                <div class="modal-body">

                    <!-- Edit session form -->
                    <form (ngSubmit)="changeSession()" #editSessionForm="ngForm">
                        <div class="form-group">
                            <label for="description">Omschrijving</label>
                            <input type="text" class="form-control" [(ngModel)]="sessionModel.description" />
                        </div>
                        <div class="form-group">
                            <label for="subtheme">Subthema</label>
                            <select class="form-control" [(ngModel)]="sessionModel.subtheme" id="subthemeSelect">
                                <option *ngFor="#s of subthemes" [value]="s.id">{{ s.name }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cardCreationAllowed">Kaartjes aanmaken toegestaan: </label>
                            <div class="checkbox">
                                <label><input type="checkbox" [(ngModel)]="sessionModel.cardCreationAllowed" /></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="startDate">Maximum kaartjes: </label>
                            <input type="number" class="form-control" [(ngModel)]="sessionModel.maxCardsToChoose" />
                        </div>
                        <div class="form-group">
                            <label for="startDate">Start datum</label>
                            <input type="date" class="form-control" [(ngModel)]="sessionModel.start" />
                        </div>
                        <div class="form-group">
                            <label for="endDate">Eind datum</label>
                            <input type="date" class="form-control" [(ngModel)]="sessionModel.end" />
                        </div>
                        <div class="form-group">
                            <label for="maxParticipants">Maximum aantal deelnemers: </label>
                            <input type="number" class="form-control" [(ngModel)]="sessionModel.maxParticipants" />
                        </div>
                        <div class="form-group">
                            <label for="users">Gebruikers toevoegen</label>
                            <br />
                            <input type="text" name="users" class="form-control" id="users" [(ngModel)]="users">
                        </div>
                        <button type="submit" class="btn btn-info" [disabled]="!editSessionForm.form.valid" data-toggle="modal" data-target="#editSessionModal">Kloon sessie</button>
                        <button type="button" class="btn btn-info" data-dismiss="modal">Sluit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Clone session modal -->
    <div id="cloneSessionModal" class="modal" role="form">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Kopiëer sessie</h4>
                </div>
                <div class="modal-body">

                    <!-- Clone session form -->
                    <form (ngSubmit)="cloneSession()" #cloneSessionForm="ngForm">
                        <div class="form-group">
                            <label for="description">Omschrijving</label>
                            <input type="text" class="form-control" [(ngModel)]="sessionModel.description" />
                        </div>
                        <div class="form-group">
                            <label for="subtheme">Subthema</label>
                            <select class="form-control" [(ngModel)]="sessionModel.subtheme" id="subthemeSelect">
                                <option *ngFor="#s of subthemes" [value]="s.id">{{ s.name }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cardCreationAllowed">Kaartjes aanmaken toegestaan: </label>
                            <div class="checkbox">
                                <label><input type="checkbox" [(ngModel)]="sessionModel.cardCreationAllowed" /></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="startDate">Maximum kaartjes: </label>
                            <input type="number" class="form-control" [(ngModel)]="sessionModel.maxCardsToChoose" />
                        </div>
                        <div class="form-group">
                            <label for="startDate">Start datum</label>
                            <input type="date" class="form-control" [(ngModel)]="sessionModel.start" />
                        </div>
                        <div class="form-group">
                            <label for="endDate">Eind datum</label>
                            <input type="date" class="form-control" [(ngModel)]="sessionModel.end" />
                        </div>
                        <div class="form-group">
                            <label for="maxParticipants">Maximum aantal deelnemers: </label>
                            <input type="number" class="form-control" [(ngModel)]="sessionModel.maxParticipants" />
                        </div>
                        <button type="submit" class="btn btn-info" [disabled]="!cloneSessionForm.form.valid" data-toggle="modal" data-target="#cloneSessionModal">Kopiëer sessie</button>
                        <button type="button" class="btn btn-info" data-dismiss="modal">Sluit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Choose card modal -->
    <div id="chooseCardModal" class="modal fade" role="form">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button id="newcard" type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Kaarten kiezen</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div *ngIf="sessionDetail.cardCreationAllowed">
                            <form (ngSubmit)="addCardToSubtheme()" #organisationForm="ngForm">
                                <div class="form-group">
                                    <label for="text">Nieuwe kaart toevoegen</label>
                                    <input id="newcardtext" type="text" class="form-control" required="" [(ngModel)]="cardModel.text" ngControl="text" #text="ngForm">
                                    <button type="submit" [disabled]="text.valid" id="newcard" class="btn btn-info btn-lg">Nieuwe kaart</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="row">
                        <ul id="allcardlist" class="cardlistModal">
                            <li *ngFor="#card of selectionCards">
                                <div class="col-xs-3 col-md-2">
                                    <div class="thumbnail">
                                        <p>{{ card.text }}</p>
                                        <button type="button" class="btn btn-info" (click)="addCardToSelection(card)">Kies</button>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="row">
                        <p>Gekozen kaarten</p>
                        <br />
                        <ul id="mycardlist" class="cardlistModal">
                            <li *ngFor="#card of playerCards">
                                <div class="col-xs-3 col-md-2">
                                    <div class="thumbnail">
                                        <p>{{ card.text }}</p>
                                        <button type="button" class="btn btn-info" (click)="removeCardFromSelection(card)">Verwijder</button>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="row">
                        <button type="button" class="btn btn-default" data-dismiss="modal" (click)="submitCards()">Start</button>
                    </div>
                </div>
            </div>
        </div>
    </div> 
</section>